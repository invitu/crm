<odoo>
    <record id="view_crm_lead_form_approval" model="ir.ui.view">
        <field name="name">view.crm.lead.form.approval</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_lead_view_form" />
        <field name="arch" type="xml">
            <xpath expr="//header" position="inside">
                <field name="to_be_approved" invisible="1" />
                <button
                    name="%(action_crm_approval_wizard)d"
                    string="Approve/Refuse"
                    type="action"
                    class="btn-primary"
                    invisible="not to_be_approved or type == 'lead'"
                    groups="sales_team.group_sale_salesman_all_leads"
                />
            </xpath>
            <xpath expr="//sheet/field[@name='active']" position="after">
                <field
                    name="approval"
                    widget="state_selection"
                    invisible="not to_be_approved or type == 'lead'"
                />
            </xpath>
        </field>
    </record>

    <record id="view_crm_lead_approval_kanban" model="ir.ui.view">
        <field name="name">view.crm.lead.approval.kanban</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_kanban_view_leads" />
        <field name="priority" eval="100" />
        <field name="arch" type="xml">
            <xpath expr="//div/field[@name='user_id']" position="after">
                <field name="to_be_approved" invisible="1" />
                <field
                    name="approval"
                    widget="state_selection"
                    invisible="not to_be_approved"
                />
            </xpath>
        </field>
    </record>

    <record id="view_crm_lead_tree_approval" model="ir.ui.view">
        <field name="name">view.crm.lead.tree.approval</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_tree_view_oppor" />
        <field name="priority" eval="100" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='name']" position="after">
                <field name="to_be_approved" invisible="1" />
                <field
                    name="approval"
                    optional="show"
                    widget="state_selection"
                    nolabel="1"
                    width="40px"
                    invisible="not to_be_approved"
                />
            </xpath>
        </field>
    </record>
    <record id="view_crm_case_opportunity_approval_filter" model="ir.ui.view">
        <field name="name">view.crm.case.opportunity.approval.filter</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.view_crm_case_opportunities_filter" />
        <field name="priority" eval="100" />
        <field name="arch" type="xml">
            <filter name="unassigned" position="after">
                <filter
                    string="Unreviewed"
                    name="unreviewed"
                    domain="[('approval', '=', 'none'), ('to_be_approved', '=', True), ('type', '=', 'opportunity')]"
                    help="Opportunities that are not yet reviewed"
                />
                <filter
                    string="Approved"
                    name="approved"
                    domain="[('approval', '=', 'done'), ('to_be_approved', '=', True), ('type', '=', 'opportunity')]"
                    help="Opportunities that are refused"
                />
                <filter
                    string="Refused"
                    name="refused"
                    domain="[('approval', '=', 'blocked'), ('to_be_approved', '=', True), ('type', '=', 'opportunity')]"
                    help="Opportunities that are refused"
                />
            </filter>
        </field>
    </record>
</odoo>
